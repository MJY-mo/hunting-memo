/* style.css - v5.2 High Visibility Fix */

/* ----------------------------------------------------------------------------
   1. テーマと色の定義 (コントラスト強化)
---------------------------------------------------------------------------- */
:root {
    /* ベース色 */
    --color-bg-primary: #f3f4f6;
    --color-bg-secondary: #ffffff;
    --color-text-primary: #111827; /* より黒く */
    --color-text-secondary: #4b5563;
    
    /* ★枠線の色を濃く変更 */
    --color-border: #6b7280; 
    --color-border-focus: #2563eb;
    
    /* ボタン色定義 */
    --btn-primary-bg: #2563eb;
    --btn-primary-text: #ffffff;
    --btn-secondary-bg: #e5e7eb;
    --btn-secondary-text: #1f2937;
    --btn-danger-bg: #dc2626;
    --btn-danger-text: #ffffff;
    --btn-success-bg: #16a34a;
    --btn-success-text: #ffffff;

    --header-height: 60px;
    
    /* フォントサイズ基準 */
    --font-size-base: 15px;
}

/* ダークテーマ */
:root.theme-dark {
    --color-bg-primary: #1f2937;
    --color-bg-secondary: #374151;
    --color-text-primary: #f9fafb;
    --color-text-secondary: #d1d5db;
    --color-border: #9ca3af; /* ダーク時は少し明るく */
    --color-border-focus: #60a5fa;
    --color-accent: #60a5fa;
}

/* 他テーマ */
:root.theme-sepia { --color-bg-primary: #fbf0e4; --color-bg-secondary: #fffefb; --color-border: #a89f91; }
:root.theme-light-green { --btn-primary-bg: #15803d; }
:root.theme-light-blue { --btn-primary-bg: #0c4a6e; }

/* 文字サイズ設定 */
:root.font-size-xsmall { --font-size-base: 12px; }
:root.font-size-small { --font-size-base: 13px; }
:root.font-size-medium { --font-size-base: 15px; }
:root.font-size-large { --font-size-base: 17px; }
:root.font-size-xlarge { --font-size-base: 20px; }

/* ----------------------------------------------------------------------------
   2. 基本リセット対策 (★ここが重要)
---------------------------------------------------------------------------- */
body {
    font-family: sans-serif;
    background-color: var(--color-bg-primary);
    color: var(--color-text-primary);
    font-size: var(--font-size-base);
    margin: 0;
}

/* Tailwindによるスタイルの消失を防ぐための強制指定 */
button, input, select, textarea {
    font-family: inherit;
    font-size: 100%;
    margin: 0;
    /* 枠線を強制的に表示 */
    border-width: 1px !important;
    border-style: solid !important;
    border-color: var(--color-border) !important;
}

/* ----------------------------------------------------------------------------
   3. 入力フォームのスタイル (視認性重視)
---------------------------------------------------------------------------- */
.form-input, 
.form-select, 
input[type="text"], 
input[type="number"], 
input[type="date"], 
textarea,
select {
    display: block;
    width: 100%;
    padding: 0.6rem 0.8rem;
    border-radius: 6px !important;
    background-color: var(--color-bg-secondary) !important;
    color: var(--color-text-primary) !important;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    margin-bottom: 0.5rem;
    
    /* ブラウザ標準の見た目を消して自前で描画 */
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
}

/* 入力欄のフォーカス時（入力中） */
.form-input:focus, .form-select:focus, input:focus, select:focus, textarea:focus {
    outline: 2px solid var(--color-border-focus) !important;
    outline-offset: -1px;
    border-color: var(--color-border-focus) !important;
}

/* Selectボックスの矢印アイコンを復活させる */
select, .form-select {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 0.5rem center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: 2.5rem !important;
}

/* ラベル */
.form-label {
    display: block;
    font-weight: 700;
    margin-bottom: 0.3rem;
    color: var(--color-text-secondary);
}
.form-group { margin-bottom: 1rem; }

/* ----------------------------------------------------------------------------
   4. ボタンのスタイル (立体感と色)
---------------------------------------------------------------------------- */
.btn {
    display: block;
    width: 100%;
    padding: 0.7rem 1rem;
    text-align: center;
    font-weight: 700;
    border-radius: 6px;
    cursor: pointer;
    border: 1px solid transparent !important; /* ボタン独自の枠線 */
    transition: background-color 0.2s;
    margin-bottom: 0.5rem;
}

/* 色指定 (Tailwindクラスを上書き) */
.btn-primary {
    background-color: var(--btn-primary-bg) !important;
    color: var(--btn-primary-text) !important;
    border-color: var(--btn-primary-bg) !important;
}
.btn-secondary {
    background-color: var(--btn-secondary-bg) !important;
    color: var(--btn-secondary-text) !important;
    border-color: var(--color-border) !important; /* グレーの枠線 */
}
.btn-danger {
    background-color: var(--btn-danger-bg) !important;
    color: var(--btn-danger-text) !important;
}
.btn-success {
    background-color: var(--btn-success-bg) !important;
    color: var(--btn-success-text) !important;
}
.btn-warning {
    background-color: #f59e0b !important;
    color: #ffffff !important;
}

/* ボタンを押したときの凹み効果 */
.btn:active {
    transform: translateY(1px);
    filter: brightness(90%);
}

/* ----------------------------------------------------------------------------
   5. ヘッダー・ナビゲーション
---------------------------------------------------------------------------- */
#header {
    background-color: var(--color-bg-secondary);
    border-bottom: 1px solid var(--color-border) !important;
    height: var(--header-height);
}
#headerTitle { font-weight: 800; font-size: 1.2rem; }

/* 戻るボタン */
#backButton {
    height: 40px;
    line-height: 1;
    background-color: var(--color-bg-primary) !important;
    border: 1px solid var(--color-border) !important;
    color: var(--color-text-primary);
    border-radius: 6px;
    padding: 0 1rem;
}

/* 下部タブバー */
nav.bg-white {
    background-color: var(--color-bg-secondary);
    border-top: 1px solid var(--color-border) !important;
}
.tab-active {
    color: var(--btn-primary-bg);
    font-weight: bold;
    background-color: rgba(0,0,0,0.05);
}
.tab-inactive { color: #6b7280; }

/* ----------------------------------------------------------------------------
   6. カード・リスト・サブタブ
---------------------------------------------------------------------------- */
.card, .trap-card, .animal-card {
    background-color: var(--color-bg-secondary);
    border: 1px solid var(--color-border) !important; /* 枠線を強制 */
    border-radius: 8px;
    padding: 0.8rem;
    margin-bottom: 0.5rem;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* サブタブ（設置中/過去など） */
.sub-tab-container {
    display: flex;
    background-color: #e5e7eb;
    padding: 4px;
    border-radius: 8px;
    border: 1px solid var(--color-border) !important;
    margin-bottom: 1rem;
}
.sub-tab-button {
    flex: 1;
    padding: 8px;
    border-radius: 6px;
    border: none !important; /* 内部ボタンは枠線なし */
    background: transparent;
    color: #4b5563;
    font-weight: 600;
}
.sub-tab-active {
    background-color: white !important;
    color: var(--btn-primary-bg) !important;
    box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

/* 写真プレビュー枠 */
.photo-preview {
    border: 2px dashed var(--color-border) !important;
    background-color: var(--color-bg-primary);
    height: 120px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 0.5rem;
    position: relative;
    overflow: hidden;
}
.photo-preview img { height: 100%; width: 100%; object-fit: contain; }

/* 削除ボタン */
.photo-preview-btn-delete {
    position: absolute; top: 0; right: 0;
    width: 30px !important; height: 30px !important;
    background: red !important; color: white;
    border: none !important;
    font-size: 1.2rem;
    line-height: 1;
}

/* バッジ */
.badge {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.8em;
    font-weight: bold;
    border: 1px solid rgba(0,0,0,0.1) !important;
}