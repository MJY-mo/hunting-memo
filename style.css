/* ★★★ 修正: フォントサイズ定義を5段階に変更 ★★★ */
:root {
    /* デフォルト (ライトテーマ) */
    --color-bg-primary: #f3f4f6; /* bg-gray-100 */
    --color-bg-secondary: #ffffff; /* bg-white (cards, header, nav) */
    --color-text-primary: #1f2937; /* text-gray-800 */
    --color-text-secondary: #4b5563; /* text-gray-600 */
    --color-border: #d1d5db; /* border-gray-300 */
    --color-border-focus: rgb(59 130 246); /* focus:border-blue-500 */
    /* font-size-base は :root.font-size-xxx で設定 */
}

:root.theme-dark {
    --color-bg-primary: #1f2937; /* bg-gray-800 */
    --color-bg-secondary: #374151; /* bg-gray-700 (cards) */
    --color-text-primary: #f9fafb; /* text-gray-50 */
    --color-text-secondary: #d1d5db; /* text-gray-300 */
    --color-border: #4b5563; /* border-gray-600 */
    --color-border-focus: rgb(96 165 250); /* focus:border-blue-400 */
}

:root.theme-sepia {
    --color-bg-primary: #fbf0e4; /* セピア背景 */
    --color-bg-secondary: #ffffff;
    --color-text-primary: #5f4b32; /* セピア文字 (濃) */
    --color-text-secondary: #7a5c3b; /* セピア文字 (淡) */
    --color-border: #dcd0c0;
    --color-border-focus: #a98f71;
}

:root.font-size-xsmall {
    --font-size-base: 12px;
}
:root.font-size-small {
    --font-size-base: 14px;
}
:root.font-size-medium {
    --font-size-base: 16px;
}
:root.font-size-large {
    --font-size-base: 18px;
}
:root.font-size-xlarge {
    --font-size-base: 20px;
}
/* ★★★ 修正ここまで ★★★ */


/* Tailwind CSSがベースですが、@apply を使わずに標準CSSで記述します */
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    overscroll-behavior-y: none;
    max-width: 640px; /* max-w-lg */
    margin: 0 auto;
    
    /* ★ 修正: CSS変数を使用 */
    background-color: var(--color-bg-primary);
    color: var(--color-text-primary);
    font-size: var(--font-size-base); /* ★ 適用 */
}

/* ★ 修正: ヘッダーとタブバーのテーマ対応 (index.html の定義に基づく) */
#header,
nav.bg-white {
    background-color: var(--color-bg-secondary);
    border-color: var(--color-border);
}
#headerTitle {
    color: var(--color-text-primary);
}


/* --- タブバー --- */
.tab-active {
    color: #059669; /* text-emerald-600 (これはテーマ固定) */
    border-top: 2px solid #059669;
    font-weight: 600; /* font-semibold */
}
.tab-inactive {
    /* ★ 修正: CSS変数を使用 */
    color: var(--color-text-secondary);
    border-top: 2px solid transparent;
}

/* --- フォーム共通スタイル (UI改善で追加) --- */
.card {
    /* ★ 修正: CSS変数を使用 */
    background-color: var(--color-bg-secondary);
    border-radius: 0.5rem; /* rounded-lg */
    padding: 1rem; /* p-4 */
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); /* shadow-lg */
}

.form-group {
    margin-bottom: 1rem; /* mb-4 */
}
.form-label {
    display: block;
    font-size: 0.875rem; /* text-sm */
    font-weight: 500; /* font-medium */
    /* ★ 修正: CSS変数を使用 */
    color: var(--color-text-primary);
    margin-bottom: 0.25rem; /* mb-1 */
}
.form-input,
.form-select {
    display: block;
    width: 100%;
    padding-left: 0.75rem;
    padding-right: 0.75rem;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
    /* ★ 修正: CSS変数を使用 */
    border: 1px solid var(--color-border);
    background-color: var(--color-bg-secondary);
    color: var(--color-text-primary);
    
    border-radius: 0.375rem; /* rounded-md */
    box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); /* shadow-sm */
    font-size: 0.875rem; /* sm:text-sm */
}
.form-input:focus,
.form-select:focus {
    outline: 2px solid transparent;
    outline-offset: 2px;
    /* ★ 修正: CSS変数を使用 */
    border-color: var(--color-border-focus);
    box-shadow: 0 0 0 2px var(--color-border-focus);
}
/* ★ 修正: inputプレースホルダーの文字色 */
.form-input::placeholder {
    color: var(--color-text-secondary);
    opacity: 0.7;
}


/* --- ボタン共通スタイル (UI改善で追加) --- */
/* (ボタン色は視認性のためテーマ変更しない) */
.btn {
    display: inline-flex;
    justify-content: center;
    padding: 0.5rem 1rem; /* py-2 px-4 */
    border: 1px solid transparent;
    box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); /* shadow-sm */
    font-size: 0.875rem; /* text-sm */
    font-weight: 500; /* font-medium */
    border-radius: 0.375rem; /* rounded-md */
    cursor: pointer;
    transition-property: background-color;
    transition-duration: 150ms;
}
.btn-primary {
    background-color: rgb(37 99 235); /* bg-blue-600 */
    color: white;
}
.btn-primary:hover {
    background-color: rgb(29 78 216); /* hover:bg-blue-700 */
}
.btn-secondary {
    /* ★ 修正: CSS変数を使用 */
    background-color: var(--color-bg-primary);
    color: var(--color-text-primary);
    border-color: var(--color-border);
}
.btn-secondary:hover {
    opacity: 0.8;
}
.btn-danger {
    background-color: rgb(220 38 38); /* bg-red-600 */
    color: white;
}
.btn-danger:hover {
    background-color: rgb(185 28 28); /* hover:bg-red-700 */
}
.btn-loading {
    opacity: 0.75;
    cursor: not-allowed;
}


/* --- ★★★ 罠カード (修正箇所) ★★★ --- */
.trap-card {
    /* ★ 修正: CSS変数を使用 */
    background-color: var(--color-bg-secondary);
    
    /* shadow-lg */
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    border-radius: 0.5rem; /* rounded-lg */
    padding: 1rem; /* p-4 */
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    transition: background-color 0.15s ease-out;
}
.trap-card:hover {
    opacity: 0.8;
}

/* ★ 修正: 罠カード内の文字色 */
.trap-card h3 {
    color: var(--color-text-primary);
}
/* (h3 の .text-blue-600 などはCSS優先度で上書きされる) */
.trap-card p {
    color: var(--color-text-secondary);
}


/* --- エラーメッセージ --- */
/* (変更なし) */
.error-box {
    background-color: #fee2e2; /* bg-red-100 */
    border: 1px solid #f87171; /* border-red-400 */
    color: #b91c1c; /* text-red-700 */
    padding: 1rem; /* px-4 py-3 */
    border-radius: 0.5rem; /* rounded-lg */
}

/* (既存のCSS... error-box まで) */
.error-box {
    background-color: #fee2e2; /* bg-red-100 */
    border: 1px solid #f87171; /* border-red-400 */
    color: #b91c1c; /* text-red-700 */
    padding: 1rem; /* px-4 py-3 */
    border-radius: 0.5rem; /* rounded-lg */
}

/* ★★★ 新規 (3/4): 画像拡大モーダル ★★★ */
.image-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.85);
    z-index: 999;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    cursor: zoom-out;
}
.image-modal-content {
    max-width: 100%;
    max-height: 100%;
}
.image-modal-content img {
    max-width: 100%;
    max-height: 95vh; /* 画面の高さの95% */
    object-fit: contain;
    border-radius: 0.25rem;
    box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.3), 0 4px 6px -4px rgb(0 0 0 / 0.3);
}

/* ★ 修正: 写真プレビューのスタイル (catch.js, info.js で使用) */
.photo-preview {
    position: relative;
    width: 100%;
    height: 8rem; /* h-32 */
    cursor: zoom-in;
    border: 2px dashed var(--color-border);
    border-radius: 0.375rem; /* rounded-md */
    background-color: var(--color-bg-primary);
    display: flex;
    align-items: center;
    justify-content: center;
}
.photo-preview img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0.375rem;
}
.photo-preview .placeholder {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
}
.photo-preview-btn-delete {
    position: absolute;
    top: 0.25rem;
    right: 0.25rem;
    background-color: rgba(220, 38, 38, 0.9); /* bg-red-600 */
    color: white;
    border-radius: 9999px; /* rounded-full */
    width: 1.5rem; /* w-6 */
    height: 1.5rem; /* h-6 */
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 0.875rem;
    border: 1px solid white;
    cursor: pointer;
    z-index: 10;
}
.photo-preview-btn-delete:hover {
    background-color: rgb(185 28 28); /* hover:bg-red-700 */
}

/*
 * ----------------------------------------------------------------
 * テーマ変更用の設定 (ファイルの最後に追加)
 * ----------------------------------------------------------------
 */

/* main.js で設定された変数を、.page-title の文字色に適用する */
.page-title {
    color: var(--color-text-primary);
}